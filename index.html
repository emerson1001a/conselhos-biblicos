<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>Conselhos B√≠blicos</title>
  <style>
    body{margin:0;background:#0f172a;color:#e5e7eb;font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu}
    .wrap{max-width:700px;margin:0 auto;padding:16px}
    header{text-align:center;margin-bottom:12px}
    .logo{width:52px;height:52px;margin:0 auto 10px;border-radius:14px;background:conic-gradient(from 180deg,#22d3ee,#a78bfa,#34d399,#22d3ee);box-shadow:0 0 20px #22d3ee66}
    h1{font-size:24px;margin:0}
    .card{background:#111827dd;border-radius:16px;padding:16px;margin-top:16px;border:1px solid #1f2937}
    textarea{width:100%;min-height:100px;background:#0b1324;border:1px solid #1e293b;color:#e5e7eb;border-radius:12px;padding:12px;font-size:15px}
    .actions,.inline-actions{display:flex;flex-wrap:wrap;gap:10px;margin-top:12px}
    button{flex:1;background:#1f2937;border:1px solid #1f8e9c;color:#fff;padding:12px;border-radius:12px;font-weight:600;cursor:pointer;font-size:15px}
    button.primary{background:#2d3748}
    .verse{font-size:18px;line-height:1.45}
    .ref{opacity:.9;margin-top:6px;font-size:14px}
    .tags{margin-top:8px;font-size:12px;color:#cbd5e1}
    .prayer{background:#0b1324;border:1px solid #1e293b;border-radius:12px;padding:10px;font-size:14px;line-height:1.45;margin-top:8px}
    .result{display:none;margin-top:16px}
    .warn{display:none;margin-top:12px;background:#0b1324;border:1px solid #1e293b;border-radius:10px;padding:10px;font-size:14px}
    @media (max-width:480px){
      .wrap{padding:12px}
      .inline-actions button{flex:1 1 100%}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo"></div>
      <h1>Conselhos B√≠blicos</h1>
      <p style="font-size:14px;color:#9ca3af">Descreva sua situa√ß√£o e receba passagens com coment√°rio e ora√ß√£o.</p>
    </header>

    <section class="card">
      <textarea id="input" placeholder="Ex.: estou ansioso; minha m√£e est√° doente; medo; luto; sem esperan√ßa; preciso rezar..."></textarea>
      <div class="actions">
        <button id="btnFind" class="primary" type="button">Encontrar passagem</button>
        <button id="btnSurprise" type="button">Surpreenda-me</button>
        <button id="btnClear" type="button">Limpar</button>
      </div>
      <p style="font-size:13px;color:#9ca3af">
        Temas entendidos: ansiedade, medo, luto, suic√≠dio, desejo de morte, pecado, sofrimento, ang√∫stia, gra√ßa, rezar/ora√ß√£o, esperan√ßa, f√©, sa√∫de/cura, fam√≠lia, solid√£o, tristeza, alegria, amor.
      </p>
      <div id="warn" class="warn"></div>
    </section>

    <section id="result" class="card result">
      <div class="verse" id="verse"></div>
      <div class="ref" id="ref"></div>
      <div class="tags" id="tags"></div>
      <div class="prayer" id="devocional"></div>
      <div class="prayer"><strong>Ora√ß√£o:</strong> <span id="oracao"></span></div>
      <div class="inline-actions">
        <button id="btnNext" type="button">Pr√≥ximo Conselho</button>
        <button id="btnCopy" type="button">Copiar</button>
        <button id="btnShare" type="button">Compartilhar</button>
      </div>
    </section>
  </div>

  <!-- opcional: deixe suicidio.m4a na mesma pasta do index.html -->
  <audio id="audioSuicidio" src="suicidio.m4a" preload="auto"></audio>

<script>
/* ===================== Utilidades ===================== */
// normaliza: min√∫sculas + remove acentos (compat√≠vel com navegadores)
function norm(s){
  return (s||'')
    .toLowerCase()
    .normalize('NFD')
    .replace(/[\u0300-\u036f]/g,'');
}
function showWarn(msg){
  const w=document.getElementById('warn');
  w.textContent=msg;
  w.style.display='block';
  clearTimeout(showWarn._t);
  showWarn._t=setTimeout(()=>{ w.style.display='none'; }, 4000);
}

/* ===================== Sin√¥nimos / Palavras-chave ===================== */
const TOPIC_KEYS = [
  {topic:'ansiedade',keys:['ansiedade','ansioso','ansiosa','preocupacao','preocupado','preocupada','aflicao','angustia','nervoso','panico','p√¢nico']},
  {topic:'medo',keys:['medo','temor','assustado','assustada','pavor','receio']},
  {topic:'luto',keys:['luto','morte','falecimento','perda']},
  {topic:'suicidio',keys:['suicidio','suic√≠dio','suicidou','tirou a vida']},
  {topic:'desejo-suicidio',keys:['me matar','tirar a vida', 'tirar a minha vida','nao quero viver','n√£o quero mais viver','suicidar']},
  {topic:'pecado',keys:['pecado','erro','falha','culpa','cometi']},
  {topic:'sofrimento',keys:['sofrimento','dor','provacao','prova√ß√£o','tribulacao','tribula√ß√£o']},
  {topic:'angustia',keys:['angustia','ang√∫stia','aperto no coracao','aperto no cora√ß√£o']},
  {topic:'graca',keys:['graca','gra√ßa','favor','misericordia','miseric√≥rdia']},
  {topic:'rezar',keys:['rezar','oracao','ora√ß√£o','pedir','suplica','s√∫plica','orar','rosario','ter√ßo']},
  {topic:'esperanca',keys:['esperanca','esperan√ßa','confianca','confian√ßa','futuro','sem esperanca','sem esperan√ßa']},
  {topic:'fe',keys:['fe','f√©','crenca','cren√ßa','acreditar','sem fe','sem f√©']},
  {topic:'cura',keys:['cura','saude','sa√∫de','doenca','doen√ßa','enfermidade','saudavel','doente','enfermo','hospital','internacao','interna√ß√£o','cirurgia','tratamento']},
  {topic:'familia',keys:['familia','fam√≠lia','casa','lar','filhos','casamento','meu filho','minha mae','minha m√£e','meu pai']},
  {topic:'solidao',keys:['solidao','solid√£o','sozinho','sozinha','abandono','isolado','isolada']},
  {topic:'tristeza',keys:['tristeza','triste','abatido','desanimo','des√¢nimo','chorar','depressao','depress√£o']},
  {topic:'alegria',keys:['alegria','feliz','contentamento','gozo','regozijo']},
  {topic:'amor',keys:['amor','amar','carinho','afeto','paixao','paix√£o']}
];

/* ===================== Vers√≠culos ===================== */
const VERSES = [
  // ANSIEDADE
  {topic:'ansiedade',ref:'Filipenses 4:6-7',text:'N√£o andeis ansiosos... a paz de Deus guardar√° o cora√ß√£o.',note:'A ansiedade √© colocada diante de Deus na ora√ß√£o.',prayer:'Senhor, entrego minhas preocupa√ß√µes a Ti.'},
  {topic:'ansiedade',ref:'Mateus 6:34',text:'N√£o vos preocupeis com o dia de amanh√£...',note:'Viva o presente com confian√ßa.',prayer:'Pai, ajuda-me a confiar no hoje.'},
  {topic:'ansiedade',ref:'Salmo 55:22',text:'Lan√ßa o teu cuidado sobre o Senhor, e Ele te suster√°.',note:'Deus carrega os fardos.',prayer:'Sustenta-me, Senhor.'},

  // MEDO
  {topic:'medo',ref:'Isa√≠as 41:10',text:'N√£o temas, porque Eu sou contigo.',note:'A presen√ßa de Deus dissipa o medo.',prayer:'Senhor, d√°-me coragem.'},
  {topic:'medo',ref:'Salmo 56:3',text:'Em me vindo o temor, confiarei em ti.',note:'A f√© vence o medo.',prayer:'Que minha confian√ßa supere o medo.'},

  // LUTO
  {topic:'luto',ref:'Jo√£o 11:25',text:'Eu sou a ressurrei√ß√£o e a vida.',note:'Cristo consola na dor.',prayer:'Jesus, consola meu cora√ß√£o.'},
  {topic:'luto',ref:'Salmo 34:18',text:'O Senhor est√° perto dos quebrantados.',note:'Deus ampara no luto.',prayer:'Sustenta-me em minha dor.'},

  // SUIC√çDIO / DESEJO DE MORTE
  {topic:'suicidio',ref:'Jo√£o 16:33',text:'No mundo tereis afli√ß√µes, mas tende bom √¢nimo.',note:'Jesus traz esperan√ßa.',prayer:`Senhor Deus de infinita miseric√≥rdia,
neste momento em que este(a) teu filho(a) se sente sobrecarregado(a), acolhe sua dor e derrama sobre ele(a) o Teu amor que cura e fortalece.
Dissipa as trevas do desespero e faz nascer a luz da esperan√ßa.
Envia pessoas que possam ajud√°-lo(a) a encontrar apoio e novo sentido para a vida.
D√°-lhe for√ßa para continuar, coragem para pedir ajuda e certeza de que n√£o est√° s√≥.
Am√©m. üôè

üü¢ Se voc√™ estiver passando por um momento dif√≠cil, ligue gratuitamente para o CVV ‚Äì 188 (24h, sigiloso) ou acesse https://www.cvv.org.br
üü¢ Procure tamb√©m apoio espiritual na sua comunidade.
Sua vida √© preciosa. Voc√™ n√£o est√° sozinho(a). üå±`},
  {topic:'suicidio',ref:'Isa√≠as 41:13',text:'Eu te ajudarei, diz o Senhor.',note:'Deus segura sua m√£o.',prayer:'Segura-me pela m√£o, Pai.'},
  {topic:'desejo-suicidio',ref:'Jo√£o 10:10',text:'Eu vim para que tenham vida...',note:'Jesus √© vida abundante.',prayer:`Senhor Deus de infinita miseric√≥rdia,
acolhe-me na Tua paz, afasta de mim a desesperan√ßa e renova em mim o desejo de viver. Am√©m. üôè

üü¢ CVV ‚Äì 188 ‚Ä¢ https://www.cvv.org.br (24h)
Sua vida √© valiosa. üå±`},
  {topic:'desejo-suicidio',ref:'Jeremias 29:11',text:'Tenho planos de paz...',note:'Deus tem futuro preparado.',prayer:'Revela-me Teus planos.'},

  // CURA / SA√öDE
  {topic:'cura',ref:'Salmo 103:3',text:'Ele perdoa todas as culpas e cura todas as enfermidades.',note:'Deus √© quem sara.',prayer:'Cura-me e renova minhas for√ßas.'},
  {topic:'cura',ref:'Jeremias 17:14',text:'Cura-me, Senhor, e serei curado; salva-me, e serei salvo.',note:'Clamor por restaura√ß√£o.',prayer:'Restaura meu corpo e minha alma.'},
  {topic:'cura',ref:'Tiago 5:14-15',text:'A ora√ß√£o da f√© salvar√° o doente.',note:'A comunidade intercede e Deus age.',prayer:'Aumenta minha f√© e concede sa√∫de.'},

  // F√â
  {topic:'fe',ref:'Hebreus 11:1',text:'A f√© √© a certeza do que se espera...',note:'Convic√ß√£o no invis√≠vel.',prayer:'Fortalece minha f√©, Senhor.'},
  {topic:'fe',ref:'Marcos 9:23',text:'Tudo √© poss√≠vel ao que cr√™.',note:'Confian√ßa que move.',prayer:'Ajuda-me na minha pouca f√©.'},

  // ESPERAN√áA
  {topic:'esperanca',ref:'Romanos 15:13',text:'O Deus da esperan√ßa os encha de paz e alegria.',note:'Esperan√ßa que transborda.',prayer:'Enche-me de esperan√ßa e paz.'},
  {topic:'esperanca',ref:'Lamenta√ß√µes 3:22-23',text:'As miseric√≥rdias do Senhor se renovam a cada manh√£.',note:'Novo come√ßo di√°rio.',prayer:'Obrigado pela Tua fidelidade.'},

  // SOFRIMENTO
  {topic:'sofrimento',ref:'Romanos 8:18',text:'Os sofrimentos de agora n√£o se comparam com a gl√≥ria futura.',note:'Olhar para o eterno.',prayer:'D√°-me perseveran√ßa na dor.'},
  {topic:'sofrimento',ref:'1 Pedro 5:10',text:'Depois de padecer, Ele vos restaurar√° e fortalecer√°.',note:'Deus firma os passos.',prayer:'Restaura-me e fortalece-me.'},

  // PECADO
  {topic:'pecado',ref:'1 Jo√£o 1:9',text:'Se confessarmos, Ele √© fiel e justo para perdoar.',note:'Perd√£o e purifica√ß√£o.',prayer:'Cria em mim um cora√ß√£o puro.'},

  // REZAR / ORA√á√ÉO
  {topic:'rezar',ref:'Filipenses 4:6',text:'Em tudo, pela ora√ß√£o e s√∫plicas, apresentem seus pedidos a Deus.',note:'Ore com gratid√£o.',prayer:'Recebe minhas s√∫plicas e d√°-me paz.'},
  {topic:'rezar',ref:'Mateus 7:7',text:'Pe√ßam, e lhes ser√° dado; busquem, e achar√£o.',note:'Deus responde.',prayer:'Ensina-me a pedir com f√©.'},

  // GRA√áA
  {topic:'graca',ref:'2 Cor√≠ntios 12:9',text:'Minha gra√ßa te basta; meu poder se aperfei√ßoa na fraqueza.',note:'Sufici√™ncia da gra√ßa.',prayer:'Que Tua gra√ßa me sustente hoje.'},

  // ANG√öSTIA / TRISTEZA
  {topic:'angustia',ref:'Salmo 46:1',text:'Deus √© ref√∫gio e fortaleza, socorro bem presente na ang√∫stia.',note:'Abrigo em tempos dif√≠ceis.',prayer:'S√™ meu ref√∫gio agora.'},
  {topic:'tristeza',ref:'Mateus 11:28',text:'Vinde a mim, todos os cansados e oprimidos...',note:'Descanso para a alma.',prayer:'Em Ti encontro descanso.'},

  // FAM√çLIA
  {topic:'familia',ref:'Prov√©rbios 22:6',text:'Instrui a crian√ßa no caminho, e n√£o se desviar√°.',note:'Educar com amor.',prayer:'Aben√ßoa minha casa e meus filhos.'}
];

/* ===================== Estado ===================== */
let currentList = [];
let idx = 0;

/* ===================== √Åudio ===================== */
function playAudioIfNeeded(topic){
  const audio=document.getElementById('audioSuicidio');
  if(!audio) return;
  if(topic==='suicidio' || topic==='desejo-suicidio'){
    try{ audio.currentTime=0; audio.play().catch(()=>{}); }catch(_){}
  }else{
    try{ audio.pause(); audio.currentTime=0; }catch(_){}
  }
}

/* ===================== Render ===================== */
function renderCurrent(){
  const box=document.getElementById('result');
  if(!currentList.length){ box.style.display='none'; return; }
  const item=currentList[idx % currentList.length];
  document.getElementById('verse').textContent='‚Äú'+item.text+'‚Äù';
  document.getElementById('ref').textContent=item.ref+' ‚Ä¢ tema: '+item.topic;
  document.getElementById('tags').textContent='#'+item.topic;
  document.getElementById('devocional').textContent=item.note;
  document.getElementById('oracao').textContent=item.prayer;
  box.style.display='block';
  playAudioIfNeeded(item.topic);
}

/* ===================== Busca de tema ===================== */
function findTopic(inputRaw){
  const s = norm(inputRaw);
  for(const t of TOPIC_KEYS){
    for(const k of t.keys){
      if(s.includes(norm(k))) return t.topic;
    }
  }
  return null;
}

/* ===================== A√ß√µes ===================== */
function compute(){
  try{
    const input = document.getElementById('input').value || '';
    const foundTopic = findTopic(input);

    if(foundTopic){
      let list = VERSES.filter(v => v.topic === foundTopic);

      // Fallback: reconheceu o tema mas n√£o h√° passagens cadastradas
      if(!list.length){
        showWarn(`Tema reconhecido (‚Äú${foundTopic}‚Äù), mas ainda sem passagens cadastradas. Mostrando conselhos gerais.`);
        const fallbackPool = VERSES.filter(v => ['esperanca','fe','ansiedade','sofrimento'].includes(v.topic));
        list = fallbackPool.length ? fallbackPool : VERSES;
      }
      currentList = list;
    }else{
      // Nenhum tema reconhecido
      showWarn('N√£o identifiquei um tema espec√≠fico. Mostrando um conselho aleat√≥rio.');
      currentList = [VERSES[Math.floor(Math.random()*VERSES.length)]];
    }

    idx = 0;
    renderCurrent();
  }catch(err){
    console.error(err);
    showWarn('Ocorreu um erro inesperado. Tente novamente.');
  }
}
function randomVerse(){
  currentList=[VERSES[Math.floor(Math.random()*VERSES.length)]];
  idx=0; renderCurrent();
}
function clearInput(){
  document.getElementById('input').value='';
  document.getElementById('result').style.display='none';
}
function nextSameTheme(){
  if(!currentList.length) return;
  idx=(idx+1)%currentList.length;
  renderCurrent();
}
function copyVerse(){
  if(!currentList.length) return;
  const i=currentList[idx];
  const text=`${i.ref}\n${i.text}\nComent√°rio: ${i.note}\nOra√ß√£o: ${i.prayer}`;
  if(navigator.clipboard){
    navigator.clipboard.writeText(text).then(()=>showWarn('Copiado!'));
  }
}
function shareVerse(){
  if(!currentList.length) return;
  const i=currentList[idx];
  const text=`${i.ref}\n${i.text}\nComent√°rio: ${i.note}\nOra√ß√£o: ${i.prayer}`;
  if(navigator.share){ navigator.share({title:'Conselho B√≠blico',text}); }
  else if(navigator.clipboard){ navigator.clipboard.writeText(text).then(()=>showWarn('Copiado para compartilhar!')); }
}

/* ===================== Liga bot√µes e atalhos ===================== */
document.getElementById('btnFind').addEventListener('click', compute);
document.getElementById('btnSurprise').addEventListener('click', randomVerse);
document.getElementById('btnClear').addEventListener('click', clearInput);
document.getElementById('btnNext').addEventListener('click', nextSameTheme);
document.getElementById('btnCopy').addEventListener('click', copyVerse);
document.getElementById('btnShare').addEventListener('click', shareVerse);

// Ctrl/Cmd+Enter no textarea dispara busca
document.getElementById('input').addEventListener('keydown', (e)=>{
  if((e.ctrlKey||e.metaKey) && e.key==='Enter'){ compute(); }
});
</script>
</body>
</html>

